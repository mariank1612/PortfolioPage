---
import '../styles/global.css';

interface Props {
	title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang="en" class="scroll-smooth">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content="Portfolio of Marian Köhler" />
		<meta name="author" content="Marian Köhler" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<link rel="icon" type="image/png" href="/favicon.png" />
		<title>{title}</title>
	</head>
	<body class="bg-background text-foreground font-sans text-base leading-relaxed tracking-[-0.02em] antialiased selection:bg-accent selection:text-background transition-colors duration-300">
        <!-- Spotlight Effect -->
        <div 
            class="pointer-events-none fixed inset-0 z-30 transition duration-300"
            id="spotlight"
            style="background: radial-gradient(600px at 0px 0px, rgba(29, 78, 216, 0.15), transparent 80%);"
        ></div>

		<div class="mx-auto min-h-screen max-w-screen-xl px-6 py-12 md:px-12 md:py-20 lg:px-12 lg:py-0">
            <div class="lg:flex lg:justify-between lg:gap-4">
                <!-- Left Column: Sticky Sidebar -->
                <header class="lg:sticky lg:top-0 lg:flex lg:max-h-screen lg:w-[45%] lg:flex-col lg:justify-between lg:py-24">
                    <slot name="sidebar" />
                </header>

                <!-- Right Column: Scrollable Content -->
                <main class="pt-24 lg:w-[53%] lg:py-24">
                    <slot />
                </main>
            </div>
		</div>

        <script>
            // Spotlight Effect
            const spotlight = document.getElementById('spotlight');
            if (spotlight) {
                window.addEventListener('mousemove', (e) => {
                    const x = e.clientX;
                    const y = e.clientY;
                    spotlight.style.background = `radial-gradient(600px at ${x}px ${y}px, rgba(29, 78, 216, 0.15), transparent 80%)`;
                });
            }

            // Smooth scroll to top when clicking name
            const nameLink = document.getElementById('name-link');
            if (nameLink) {
                nameLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            }

            // Scroll Spy - Improved to handle long sections
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.nav-link');

            const observerOptions = {
                root: null,
                rootMargin: '-20% 0px -60% 0px',
                threshold: [0, 0.1, 0.25, 0.5, 0.75, 1.0]
            };

            const observerCallback = (entries: IntersectionObserverEntry[]) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        
                        // Remove active class from all links
                        navLinks.forEach((link) => {
                            link.classList.remove('active');
                        });

                        // Add active class to current link
                        const activeLink = document.querySelector(`.nav-link[href="#${id}"]`);
                        if (activeLink) {
                            activeLink.classList.add('active');
                        }
                    }
                });
            };

            const observer = new IntersectionObserver(observerCallback, observerOptions);
            sections.forEach((section) => observer.observe(section));
        </script>
	</body>
</html>
